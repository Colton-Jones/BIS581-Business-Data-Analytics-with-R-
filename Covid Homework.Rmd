---
title: "R Notebook"
output: html_notebook
---

```{r}
library(dplyr)
library(ggplot2)
```

```{r}
covid22 <- readRDS('covid22.rds')
```

```{r}
str(covid22) 
```

```{r}
summary(covid22)
```

How many different vaccine manufacturers are there?
##Send the unique manufacturers to a new DS, get the count of the rows, and print it to the screen.
```{r}
manufacturers <- unique(covid22$VAX_MANU)
diff_manufacturers <- length(manufacturers)
cat("The number of different vaccine manufacturers is:", diff_manufacturers)
```

Create a plot to show adverse events by month for each manufacturer
```{r}
covid22_months <- format(as.Date(covid22$TODAYS_DATE), "%m") 
ggplot(data = covid22, mapping = aes(x=covid22_months, fill=VAX_MANU)) +
  geom_bar(stat = "count") +
  ylab("Count of Adverse Events") +
  xlab("Month of Reported Adverse Events") +
  theme_dark() +
  labs(fill = "Vaccine Manufacturer") +
  ggtitle("Adverse events by month & manufacturer") 
```

Which state had the highest number of events?
```{r}
events_per_state <- table(covid22$STATE) %>%
events_by_state <- covid22 %>% 
group_by(STATE) %>% summarise(num_events = n()) %>%
slice(-1) %>%
state_with_most_events <- events_by_state %>% filter(num_events == max(num_events))
cat("The state with the highest number of events is:", state_with_most_events$STATE)
```

```{r}
events_per_state <- table(covid22$STATE)
events_by_state <- covid22 %>% 
  group_by(STATE) %>% 
  summarise(num_events = n()) %>%
  slice(-1)
state_with_most_events <- events_by_state %>% filter(num_events == max(num_events))
cat("The state with the highest number of events is:", state_with_most_events$STATE)
```


For Florida, Georgia, and Alabama show number of events by gender
```{r}
fl_ga_al <- grep("FL|GA|AL", covid22$STATE)
events_by_gender <- table(covid22$SEX[fl_ga_al], covid22$STATE[fl_ga_al])
print(events_by_gender)
```

How many ER/ED visits were reported?
```{r}
er_visits <- covid22 %>% filter(ER_ED_VISIT == "Y")
number_of_visits <- nrow(er_visits)
cat("The number of ER/ED visits reported is:", number_of_visits)
```

Which manufacturer is associated with the highest number of reported ER/ED visits?

```{r}

```














