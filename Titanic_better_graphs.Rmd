---
title: "R Notebook"
output:
  word_document: default
  html_notebook: default
---

#Load Librarys
```{r}
library(tidyverse)
library(patchwork)
```

#Import Dataset
```{r}
titanic <- read.csv("titanic(1).csv",header=TRUE)
```

#EDA
```{r}
str(titanic)
summary(titanic)
```

#Wrangle
```{r}
titanic$Name <- as.character(titanic$Name)
titanic$Survived <- as.factor(titanic$Survived)
titanic$PClass <- as.factor(titanic$PClass)
titanic$Survived <- fct_recode(titanic$Survived,"Died"="0","Lived"="1")
str(titanic)
```
#Create variable title, extract the second word of each name.
```{r}
titanic$Title <- sapply(titanic$Name, FUN=function(x) 
{regmatches(x,regexec(',[[:space:]](.*?)[[:space:]]',x))[[1]][2]})
```
#Create variable gender, create list of female titles and if they are in the list then the gender #is set to female if not it is set to male.
```{r}
Female_titles <- c("Miss","Mrs","Lady","Madame","Ms")
titanic$Gender <- ifelse(titanic$Title %in% Female_titles, "Female","Male")
```
#Create new variable for maritial status
```{r}
titanic$martial_status <- ifelse(titanic$Title %in% c("Mrs", "Lady", 
"Madame"), "Married", "Not married")
titanic$martial_status <- as.factor(titanic$martial_status)
```

#Change new variables into factors so we can plot them.
```{r}
titanic$martial_status <- as.factor(titanic$martial_status)
titanic$Gender <- as.factor(titanic$Gender)
```

Is there a relationship between survival and gender? - Yes.
```{r}
plot1 <- titanic %>% 
ggplot(data=titanic,mapping=aes(x=Survived,fill=Gender)) +
 geom_bar(stat="count") +
 xlab("Survival") +
 ylab("Count") +
 ggtitle("Relationship between Survival and Gender")+
  scale_fill_manual(values = c("gray", "black"))
```
#pass titanic to a new dataset to get rid of annoying class *
```{r}
titanic_right <- titanic %>% 
  filter(PClass != "*")
```
Is there a relationship between survial and class? -Yes
```{r}
plot2 <- titanic_right %>% 
ggplot(data=titanic_right,mapping=aes(x=Survived,fill=PClass)) +
 geom_bar(stat = "count") +
 xlab("Survival") +
 ylab("Passenger Class") +
 ggtitle("Relationship between survival and class") +
  scale_fill_manual(values = c("grey", "black", "orange"))
```

Is there a relationship between survival and marital status?
#Create new dataset and filter for only females, since we cannot do males.
```{r}
titanic_females <- titanic %>% 
  filter(Gender == "Female")
```
#Reorder it.
```{r}
titanic_females$Survived <- fct_rev(titanic_females$Survived) 
```
Is there a relationship between survival and marital status? - yes it seems like less married women died then non-women. We dont have enough data for males.
```{r}
plot3 <- titanic_females %>% 
ggplot(data = titanic_females,mapping = aes(x=Survived,fill=martial_status)) +
geom_bar(stat = "count") +
 xlab("survival") +
 ylab("martial status") +
 ggtitle("Relationship between survival and martial status for females") +
  scale_fill_manual(values = c("gray", "black"))
```

```{r}
((plot1 / plot2 / plot3)) +
plot_annotation(title = "Titanic Relationship Plots",
theme = theme(plot.title = element_text(size = 20,
colour = "purple"))) +
theme(text = element_text('mono'))
```

